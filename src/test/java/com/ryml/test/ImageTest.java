package com.ryml.test;

import sun.misc.BASE64Decoder;

import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStream;
import java.util.UUID;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * description:
 *
 * @author 刘一博
 * @version V1.0
 * @date 2020/3/4 17:51
 */
public class ImageTest {

    public static void main(String[] args) {
        try{
            String suffix = getSuffix("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCABGAGMDASIAAhEBAxEB/8QAHAAAAgIDAQEAAAAAAAAAAAAABgcABQMECAkC/8QAOhAAAgECBQIEBQEGBAcAAAAAAQIDBBEABQYSITFBBxMiURQyYXGBFSNCgpGh0QgWscEXJDNicpLh/8QAGwEAAgMBAQEAAAAAAAAAAAAAAwUBAgQGBwD/xAAtEQACAgEDAgQFBAMAAAAAAAABAgARAwQSITFhBSJBURNxgZGxFDOh0ZLw8f/aAAwDAQACEQMRAD8A9CdKaxyjW TxZnllQIz0kWGVZRG3sbf726HgYL488pctjp0rswhjMziOIysEDseignqT7Y8wPD/xOzbw6zumzfJXSaSnVjLEWZo3sGBVhezAC4sTcEDgHBb4lePU3jHnmmv1LdlElLKwamy12poyhj czbmJDMwuCPSFB564kC kEuVXnpCMxpSxAkTnrz1OPiooKSrF2iikF72Zb44 154/yZhoSgptOPPJWrL8NX5xBu/bteyxwSNCFaRkKsxtGVLIQeeTfws8QcwzLSJkq88lzjMFkKSTikamAIVQyjgLIA4ezL 6yggHr8ATCWI0NR5KKOc1FPIaS5vtiNx9/oMaUOZZvTo2yp IXrdhigp9fGJws0e 3c8k4zV2taOSJY46dFB5JAscWoyLEP8ATurPigiVNo3HH0wSPmkESBncBT3wiV1BTxzeau5R7Xtj4zPXzeVtDOewF8W2Su8R4SZhQVDhDGsoI5IANvvjJHkVAsyzxwKh6 ngH8YQen9XLFViV3k3e5OGrkfiLSzwk1BsoHBUYqVIlgwMMGWcS l0EVuhHOBHVta9LHLFH5Cb2swCWv8AU4oNS/4htK5VG8dNUyZhPyCtGm8D IkKfwTgB/4zZBnJkNTPU0I5samEtu/9N39cRtPtJsQr/WEj9Bjprjj/AKS/2xMC8eoNP1MaypmtHtcXG ZVP5BII xGJj7bIuca0 VUNFRmKISSBIxCPMkZxYCw79uf54VGc1sUdYiFEQtMTvSyhOWtfkCwG083PFutsZM71rJCxWorREZEKuiEuBG3ysVPzkm4A9jz14XU9Wud009WqKfS1qfkF4hcqTs3EAC/JsBtbpcYypk2tC61UxkUOYwazVlTl9TBFUM0bbgyJ51geg3K17AixHI57Xvg9oPEv9e1dTSZjX/B0Q2M8ckYdDEiEJGi W3I52NY2JDEqdznnDMsyd5IFlESqrB0k81XKi3JcdA5JsdwHS4/7iCr1kJqZXCebMzpuWJtx3G3IN7ACx5vcfjGtiOKi0uyek9OkznI0yujqavO6SVpYkLSRt5hYlb7tsYNgevQWv0HTGj/AJ00wKlIfjJdpYr5whbYB7ni9vxf6Y5R8KfErN6rKCmpY4lUELBLCUAWMKNostwR27WIN OcMajzOHMVVoRdW4WxLXPPHHTpgisrDrNWxiA1cR10moNP5tWTU8eYiERn0y1I8qOQe6lrf1scSsmyChcmfOKYqLEmJ/N4/gv74UALw2EsbISbC45v9sYaqtCEIlye5wWjB0Ixq3xCyjL5AlFRyVwBIZ5JPKB wsTz7m329qDUmvq3NaY06FaSie96eIm7CxFmPfqeOB044wLRyK 1wq3 Ui2JUQtKrBArMRwrttBbtiGdEFuaElULcCRc1YHbbaCbe Nt53jX1qGv0NuDjRkSjpYyamWJPLXdIQzEKPftx2x9RVdPPEBT1EdQgAuqHlR2vx/pgC6zA7hFYWYQ4XWyfSbnnlufKP8AMYmA6s8R8uy qlpiJZGibaWUra/fv MTFzqcQNbozXwbXsAwxnn5TgRc7q2Suy7MkngqYlG6OoUblQj5gSf/AB hHS1 dShzqoo03RSxOA/7EeUfV0b0m1gzWH16cjDA8XNVZJXatqXro2yqR4FaGp2SJL5T36Bo1Nmte2212J7k4V0Twy5zW0kDK1MZGSOGViSoJuCeDe3Pbp0YYXb/ADMKg9R4Zkx48eZXDB6HXkHngj06fL2mxqWukOYRVFow8t3NySX6dz0P1474t8hzeonhApYnLIm0RwLtSJiebi1hcA82t174JtNabyPN6j9PzigneljW7VeWRh6gSMONrIjXv127WIsbscaGcpJompkp6eizujpFXzaaunp2uvf170VSB6b2C3vb94nB1y2oWoPWeHPoyqv5getDnrR4PWNrT2saZaB6EWpKOBY12yMzMzAftDckBQTa1 Ab8nB1kmqnRiIZ2QgEtsbqbf8A3698cryamqqeSeoSuRZYl8qWIxrEpJNyCpazdOQeBxbrhxeDTPqmlqGomSorN7VLK5tNt3BWJ3NbuptyfVc33YAwKi430WXE1YW6d J0Zluta2PLS1XA0yIDscvud L82v8A3xpv4pUdJUSQ1NHIz3bYigE8A8MTwOQB/FgA1FqSp0SzR1aybChcw7DcKAbgjsbr0txcG1ucK/VfiZUpkrVMOV1S0VRJGPJjlIAeMjckgQ7jyVK3sBxYe4RqMgIAlNTp8eDHkbbuJHHb Oh6TpfNvEs0NK1UG Hjji8xhK1 O/Tra46E/njApm2r3qcuqhT1ZRp442anA8pkBXcbPe/IUm9hbcLe5TOT Jq Iui8yeSlKsoaNZlhIVBtZnQC/NwQOoBDWt72uWTDIUXMKt54oQjkGaGQpK4YubNbaLbCbXLH1EG1sI9QmRnbeeYsxklgMdtX35/0QugqqjTuVoaysjGWwwPIUnJaaT94R3sSTcnqASF5HFyV6a1L iZXWVkcSOlNDJ5kS7fmW 3pwP3PV1IH0uUhm pc6zzMDQTw bltWJ41ZSGCbJbqCQ3PAU9 GBGDbQ6JmdDPlc2YRUFeU2SBnRlYIU3Eb3SxKu9r93HBI24xqrjLj2jm/T8xjp7V7z4zsFX3Ht8zMYr5agCRqpNx6iQIWFuOSecTC11Zn0ORajr8uigrJlpZDCZKeBZI2ZeGKOCAyk3sw4I5BIN8TDqif Gernxvw9TQv/Fv6i71dBpqm1ZnVPUCenipJp6cQQRKghjWZgqxt6gwFyd5sWte9zii1BHppYah4K6pObItoisxcyEGyhgEWwsLdb/fpgp1TpfLXq616qcQxb0RUV SUJUFrderc/c4EVyqlaukkkaOYCRm3biAfYAj6Drx2wwSiTyeJ5VkztgwIuTb5yPax15NVVenF9Y0PA7NxHAXy6kObZheMzVFTUuGjk8uUCNVMVrAm/G61uvIIMvFbNTm9Fk8OtaOCgKzF4JQ8iecy2VxxAQRYixK3BPHfAFoitpskqZqiprEoKZ/UrINxV7G3W/Fj2xrax1FnGsrSTVslTRU29Ymjjvfdbde4 n0tiyjceCRB63OunIDNvJ7d/vz1gXqFcoL1M2Wuj1W8CQRsy2FyQoGwWHF7jpYD7kOjGokj82tqBGkUBZGmUSLuslttxYNbnaBzyDfnFM1BIqSj4WIsVuzuoL/AF7X7YcvhtqmtyPJBQCbzYCzIIpWVkQEBWKoeLnuevX3OLZKC1cxaZm1OfhR9RxAbLMwqBLAYWjnonJBlMADxpY2CERnaNyi20AfTqcH0mZOaDLFiDUmXwkCmlgd0aRjuDs9qZtzWB6 5HTjFlmitnmaSVM1N5s1iBI8AUEkAlunU2W577R7YEM8TNKGiNNE9OCsoYKsSFrkDkG1 1sLiFdgLqNcuobT4irix2E0ZNRVlLktbTZWggR4JJvJp4VW7bbAtspY73Ujni4NyT1UTy7OszhyiOWHLYEkaAq1WaMSSbtshsspB8vgsbjn0AX4wcaUyebTeQVrSoEZXZuYkckshU/jhRbvi2o6PKM1jFPBTwwy08REbJRJGzKbgqWUXPXviLXHurnvE66ks1MNvHt/PWBGgZ8uky41Vdn0hzF/my6nhjplR2KqvrK2k4A9rX6jk4d3h9lGVECWt0pUampEl86pzCoelaVyIuA3muikKSQSCOXY8C4K4OUV9Pmp/wCVp1gaaaok3HYVckAbbj5bKv8AP74YOhNQV Rfq9VIsyB6UxpSoqNGrF0Hm36B1UGzDk35vbFPihcm66uM/wBSjYvhKd1V6H zLic6dhmeJdA544jPlh6do4kfbxuVVQAA2vwBe97DEwvNU Kesa7UVfUUfnJSySlokicRqq9gFAsLdMTFdt83 JvK51NHKw hiLr4pfh56molM7zuvJPIJJ/sf54qoHIID oKSD/r/viYmGwM4zIoJ5maVwzcljcC1yeDfnvg 0YJ6rKalaSc0z092dbAq4VSxN t LYmJizHyyyjkGXNDBDWR1M9UCrcg So6Wv04GDbKtG0tMKSR3aanljWQr8jc2uOPuMTEwFRZnT6byqGHWM2HLoaOnpEgZ1EnJN/vxjQpMmpzmVRJXRx1Tb3C3QcKRcfmxGJiY1pjSxxML5X2ZBfWvzBLVmX/D09YY22U4VkCKbH1E/3xSVs0OX5ZAYottXYStKAButbgj8/0xMTHLn9zIvoDM PkqTKuuzubMoqmFlFyjKDfgE2NwPuOmLrQdS1TFmMCgbquJ6ZQ3yrxYH Z/piYmKEldldvzNmjUfFBrm4F1lLIlS6lYyRYX3N7YmJiYaUJ7cACLqf/9k=");
            String base64 = getBase64("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCABGAGMDASIAAhEBAxEB/8QAHAAAAgIDAQEAAAAAAAAAAAAABgcABQMECAkC/8QAOhAAAgECBQIEBQEGBAcAAAAAAQIDBBEABQYSITFBBxMiURQyYXGBFSNCgpGh0QgWscEXJDNicpLh/8QAGwEAAgMBAQEAAAAAAAAAAAAAAwUBAgQGBwD/xAAtEQACAgEDAgQFBAMAAAAAAAABAgARAwQSITFhBSJBURNxgZGxFDOh0ZLw8f/aAAwDAQACEQMRAD8A9CdKaxyjW TxZnllQIz0kWGVZRG3sbf726HgYL488pctjp0rswhjMziOIysEDseignqT7Y8wPD/xOzbw6zumzfJXSaSnVjLEWZo3sGBVhezAC4sTcEDgHBb4lePU3jHnmmv1LdlElLKwamy12poyhj czbmJDMwuCPSFB564kC kEuVXnpCMxpSxAkTnrz1OPiooKSrF2iikF72Zb44 154/yZhoSgptOPPJWrL8NX5xBu/bteyxwSNCFaRkKsxtGVLIQeeTfws8QcwzLSJkq88lzjMFkKSTikamAIVQyjgLIA4ezL 6yggHr8ATCWI0NR5KKOc1FPIaS5vtiNx9/oMaUOZZvTo2yp IXrdhigp9fGJws0e 3c8k4zV2taOSJY46dFB5JAscWoyLEP8ATurPigiVNo3HH0wSPmkESBncBT3wiV1BTxzeau5R7Xtj4zPXzeVtDOewF8W2Su8R4SZhQVDhDGsoI5IANvvjJHkVAsyzxwKh6 ngH8YQen9XLFViV3k3e5OGrkfiLSzwk1BsoHBUYqVIlgwMMGWcS l0EVuhHOBHVta9LHLFH5Cb2swCWv8AU4oNS/4htK5VG8dNUyZhPyCtGm8D IkKfwTgB/4zZBnJkNTPU0I5samEtu/9N39cRtPtJsQr/WEj9Bjprjj/AKS/2xMC8eoNP1MaypmtHtcXG ZVP5BII xGJj7bIuca0 VUNFRmKISSBIxCPMkZxYCw79uf54VGc1sUdYiFEQtMTvSyhOWtfkCwG083PFutsZM71rJCxWorREZEKuiEuBG3ysVPzkm4A9jz14XU9Wud009WqKfS1qfkF4hcqTs3EAC/JsBtbpcYypk2tC61UxkUOYwazVlTl9TBFUM0bbgyJ51geg3K17AixHI57Xvg9oPEv9e1dTSZjX/B0Q2M8ckYdDEiEJGi W3I52NY2JDEqdznnDMsyd5IFlESqrB0k81XKi3JcdA5JsdwHS4/7iCr1kJqZXCebMzpuWJtx3G3IN7ACx5vcfjGtiOKi0uyek9OkznI0yujqavO6SVpYkLSRt5hYlb7tsYNgevQWv0HTGj/AJ00wKlIfjJdpYr5whbYB7ni9vxf6Y5R8KfErN6rKCmpY4lUELBLCUAWMKNostwR27WIN OcMajzOHMVVoRdW4WxLXPPHHTpgisrDrNWxiA1cR10moNP5tWTU8eYiERn0y1I8qOQe6lrf1scSsmyChcmfOKYqLEmJ/N4/gv74UALw2EsbISbC45v9sYaqtCEIlye5wWjB0Ixq3xCyjL5AlFRyVwBIZ5JPKB wsTz7m329qDUmvq3NaY06FaSie96eIm7CxFmPfqeOB044wLRyK 1wq3 Ui2JUQtKrBArMRwrttBbtiGdEFuaElULcCRc1YHbbaCbe Nt53jX1qGv0NuDjRkSjpYyamWJPLXdIQzEKPftx2x9RVdPPEBT1EdQgAuqHlR2vx/pgC6zA7hFYWYQ4XWyfSbnnlufKP8AMYmA6s8R8uy qlpiJZGibaWUra/fv MTFzqcQNbozXwbXsAwxnn5TgRc7q2Suy7MkngqYlG6OoUblQj5gSf/AB hHS1 dShzqoo03RSxOA/7EeUfV0b0m1gzWH16cjDA8XNVZJXatqXro2yqR4FaGp2SJL5T36Bo1Nmte2212J7k4V0Twy5zW0kDK1MZGSOGViSoJuCeDe3Pbp0YYXb/ADMKg9R4Zkx48eZXDB6HXkHngj06fL2mxqWukOYRVFow8t3NySX6dz0P1474t8hzeonhApYnLIm0RwLtSJiebi1hcA82t174JtNabyPN6j9PzigneljW7VeWRh6gSMONrIjXv127WIsbscaGcpJompkp6eizujpFXzaaunp2uvf170VSB6b2C3vb94nB1y2oWoPWeHPoyqv5getDnrR4PWNrT2saZaB6EWpKOBY12yMzMzAftDckBQTa1 Ab8nB1kmqnRiIZ2QgEtsbqbf8A3698cryamqqeSeoSuRZYl8qWIxrEpJNyCpazdOQeBxbrhxeDTPqmlqGomSorN7VLK5tNt3BWJ3NbuptyfVc33YAwKi430WXE1YW6d J0Zluta2PLS1XA0yIDscvud L82v8A3xpv4pUdJUSQ1NHIz3bYigE8A8MTwOQB/FgA1FqSp0SzR1aybChcw7DcKAbgjsbr0txcG1ucK/VfiZUpkrVMOV1S0VRJGPJjlIAeMjckgQ7jyVK3sBxYe4RqMgIAlNTp8eDHkbbuJHHb Oh6TpfNvEs0NK1UG Hjji8xhK1 O/Tra46E/njApm2r3qcuqhT1ZRp442anA8pkBXcbPe/IUm9hbcLe5TOT Jq Iui8yeSlKsoaNZlhIVBtZnQC/NwQOoBDWt72uWTDIUXMKt54oQjkGaGQpK4YubNbaLbCbXLH1EG1sI9QmRnbeeYsxklgMdtX35/0QugqqjTuVoaysjGWwwPIUnJaaT94R3sSTcnqASF5HFyV6a1L iZXWVkcSOlNDJ5kS7fmW 3pwP3PV1IH0uUhm pc6zzMDQTw bltWJ41ZSGCbJbqCQ3PAU9 GBGDbQ6JmdDPlc2YRUFeU2SBnRlYIU3Eb3SxKu9r93HBI24xqrjLj2jm/T8xjp7V7z4zsFX3Ht8zMYr5agCRqpNx6iQIWFuOSecTC11Zn0ORajr8uigrJlpZDCZKeBZI2ZeGKOCAyk3sw4I5BIN8TDqif Gernxvw9TQv/Fv6i71dBpqm1ZnVPUCenipJp6cQQRKghjWZgqxt6gwFyd5sWte9zii1BHppYah4K6pObItoisxcyEGyhgEWwsLdb/fpgp1TpfLXq616qcQxb0RUV SUJUFrderc/c4EVyqlaukkkaOYCRm3biAfYAj6Drx2wwSiTyeJ5VkztgwIuTb5yPax15NVVenF9Y0PA7NxHAXy6kObZheMzVFTUuGjk8uUCNVMVrAm/G61uvIIMvFbNTm9Fk8OtaOCgKzF4JQ8iecy2VxxAQRYixK3BPHfAFoitpskqZqiprEoKZ/UrINxV7G3W/Fj2xrax1FnGsrSTVslTRU29Ymjjvfdbde4 n0tiyjceCRB63OunIDNvJ7d/vz1gXqFcoL1M2Wuj1W8CQRsy2FyQoGwWHF7jpYD7kOjGokj82tqBGkUBZGmUSLuslttxYNbnaBzyDfnFM1BIqSj4WIsVuzuoL/AF7X7YcvhtqmtyPJBQCbzYCzIIpWVkQEBWKoeLnuevX3OLZKC1cxaZm1OfhR9RxAbLMwqBLAYWjnonJBlMADxpY2CERnaNyi20AfTqcH0mZOaDLFiDUmXwkCmlgd0aRjuDs9qZtzWB6 5HTjFlmitnmaSVM1N5s1iBI8AUEkAlunU2W577R7YEM8TNKGiNNE9OCsoYKsSFrkDkG1 1sLiFdgLqNcuobT4irix2E0ZNRVlLktbTZWggR4JJvJp4VW7bbAtspY73Ujni4NyT1UTy7OszhyiOWHLYEkaAq1WaMSSbtshsspB8vgsbjn0AX4wcaUyebTeQVrSoEZXZuYkckshU/jhRbvi2o6PKM1jFPBTwwy08REbJRJGzKbgqWUXPXviLXHurnvE66ks1MNvHt/PWBGgZ8uky41Vdn0hzF/my6nhjplR2KqvrK2k4A9rX6jk4d3h9lGVECWt0pUampEl86pzCoelaVyIuA3muikKSQSCOXY8C4K4OUV9Pmp/wCVp1gaaaok3HYVckAbbj5bKv8AP74YOhNQV Rfq9VIsyB6UxpSoqNGrF0Hm36B1UGzDk35vbFPihcm66uM/wBSjYvhKd1V6H zLic6dhmeJdA544jPlh6do4kfbxuVVQAA2vwBe97DEwvNU Kesa7UVfUUfnJSySlokicRqq9gFAsLdMTFdt83 JvK51NHKw hiLr4pfh56molM7zuvJPIJJ/sf54qoHIID oKSD/r/viYmGwM4zIoJ5maVwzcljcC1yeDfnvg 0YJ6rKalaSc0z092dbAq4VSxN t LYmJizHyyyjkGXNDBDWR1M9UCrcg So6Wv04GDbKtG0tMKSR3aanljWQr8jc2uOPuMTEwFRZnT6byqGHWM2HLoaOnpEgZ1EnJN/vxjQpMmpzmVRJXRx1Tb3C3QcKRcfmxGJiY1pjSxxML5X2ZBfWvzBLVmX/D09YY22U4VkCKbH1E/3xSVs0OX5ZAYottXYStKAButbgj8/0xMTHLn9zIvoDM PkqTKuuzubMoqmFlFyjKDfgE2NwPuOmLrQdS1TFmMCgbquJ6ZQ3yrxYH Z/piYmKEldldvzNmjUfFBrm4F1lLIlS6lYyRYX3N7YmJiYaUJ7cACLqf/9k=");
            BASE64Decoder decoder = new BASE64Decoder();
                // Base64解码
                byte[] b = decoder.decodeBuffer(base64);
                String savePath = "E:\\";
                String random = UUID.randomUUID().toString();
                String imgFileName = savePath + random + "." + suffix;
                File toFile = new File(imgFileName);

                OutputStream out = new FileOutputStream(toFile);
                out.write(b);
                out.flush();
                out.close();
        }catch (Exception e){

        }
    }

    private static String getBase64(String imgSrc) {
        String reg1 = "data:image/\\S*;base64,(\\S*)";
        Pattern pattern1 = Pattern.compile(reg1);
        Matcher matcher1 = pattern1.matcher(imgSrc);
        while (matcher1.find()) {
            return matcher1.group(1);
        }
        return "";
    }

    private static String getSuffix(String imgSrc) {
        String reg1 = "data:image/(\\S*);";
        Pattern pattern1 = Pattern.compile(reg1);
        Matcher matcher1 = pattern1.matcher(imgSrc);
        while (matcher1.find()) {
            return matcher1.group(1);
        }
        return "";
    }



}
